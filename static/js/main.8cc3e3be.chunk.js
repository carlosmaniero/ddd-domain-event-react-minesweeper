(window["webpackJsonpddd-domain-event-react-minesweeper"]=window["webpackJsonpddd-domain-event-react-minesweeper"]||[]).push([[0],{16:function(e,t,n){e.exports=n(28)},21:function(e,t,n){},22:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var r,i=n(0),o=n.n(i),a=n(11),u=n.n(a),s=(n(21),n(5)),c=(n(22),n(3)),l=n(4),d=function(e){return function(t){return t.type===e}},f=function(e){return{isTypeOf:function(t){return e.some((function(e){return e.isTypeOf(t)}))}}},h=function(e){return Object.assign((function(t){return{type:e,payload:t}}),{type:e,isTypeOf:d(e)})};!function(e){e.Mine="Mine",e.NotMine="NotMine"}(r||(r={}));var b,v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.random,i=function(t){return t.sameOf(e)},o=function(t){return t.isAdjacentOf(e)},a=function(){return n()<=t},u=function(e){return!i(e)&&!o(e)&&a()};return function(e){return u(e)?r.Mine:r.NotMine}},m=function(){function e(t,n){Object(c.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(l.a)(e,[{key:"isAdjacentOf",value:function(e){var t=this;return e.getAdjacent().some((function(e){return e.sameOf(t)}))}},{key:"getAdjacent",value:function(){return[e.of({x:this.x-1,y:this.y-1}),e.of({x:this.x,y:this.y-1}),e.of({x:this.x+1,y:this.y-1}),e.of({x:this.x-1,y:this.y}),e.of({x:this.x+1,y:this.y}),e.of({x:this.x-1,y:this.y+1}),e.of({x:this.x,y:this.y+1}),e.of({x:this.x+1,y:this.y+1})]}},{key:"isPresent",value:function(e){var t=this;return e.some((function(e){return t.sameOf(e)}))}},{key:"sameOf",value:function(e){return this.x===e.x&&this.y===e.y}}],[{key:"of",value:function(t){return new e(t.x,t.y)}}]),e}(),p=function(){function e(t){Object(c.a)(this,e),this.board=t,this.board=t}return Object(l.a)(e,[{key:"nearBombCount",value:function(e){return this.getAdjacent(e).filter((function(e){return e===r.Mine})).length}},{key:"isBomb",value:function(e){return this.getByCoordinate(e)===r.Mine}},{key:"hasBombNear",value:function(e){return this.nearBombCount(e)>0}},{key:"getWidth",value:function(){return this.board[0].length}},{key:"getHeight",value:function(){return this.board.length}},{key:"bombCount",value:function(){return this.board.flat().filter((function(e){return e===r.Mine})).length}},{key:"coordinates",value:function(){var e=this;return y(this.getHeight()).flatMap((function(t){return function(t){return y(e.getWidth()).map((function(e){return m.of({x:e,y:t})}))}(t)}))}},{key:"containsCoordinate",value:function(e){return!(e.y<0||e.x<0)&&(e.y<this.getHeight()&&e.x<this.getWidth())}},{key:"getAdjacent",value:function(e){var t=this;return e.getAdjacent().map((function(e){return t.getByCoordinate(e)}))}},{key:"getByCoordinate",value:function(e){var t=this.board[e.y];return t?t[e.x]:r.NotMine}}]),e}(),y=function(e){return Array.from({length:e},(function(e,t){return t}))},g=function(e){return function(t){return new p((n=function(e,t){return function(n){return y(t).map((function(t){return e(m.of({x:t,y:n}))}))}}(e,t.width),r=t.height,y(r).map(n)));var n,r}};!function(e){e.EASY="Easy",e.MEDIUM="Medium",e.HARD="Hard"}(b||(b={}));var E=function(e){switch(e){case b.EASY:return{mineProbability:.2,boardSize:{width:6,height:9}};case b.MEDIUM:return{mineProbability:.2,boardSize:{width:9,height:12}};case b.HARD:return{mineProbability:.17,boardSize:{width:12,height:15}}}},w=n(6),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(c.a)(this,e),this.revealedCoordinates=t}return Object(l.a)(e,[{key:"sweep",value:function(t,n){var r=this.isRevealed(t)?this.revealedCoordinates:[].concat(Object(w.a)(this.revealedCoordinates),[t]);return new e(e.propagateSweep(r,n))}},{key:"isRevealed",value:function(e){return this.revealedCoordinates.some((function(t){return t.sameOf(e)}))}},{key:"hasCoordinatesToBeSwept",value:function(e){return e.bombCount()<this.totalToSweep(e)}},{key:"totalToSweep",value:function(e){return e.getHeight()*e.getWidth()-this.revealedCoordinates.length}}],[{key:"propagateSweep",value:function(t,n){var r=n.coordinates().filter((function(e){return function(e){return e.isPresent(t)}(e)||function(e){return e.getAdjacent().filter((function(e){return n.containsCoordinate(e)})).filter((function(e){return e.isPresent(t)})).some((function(e){return!n.hasBombNear(e)}))}(e)}));return r.length!==t.length?e.propagateSweep(r,n):r}}]),e}(),C=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new O,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Object(c.a)(this,e),this.eventPublisher=t,this.mineFactory=n,this.gameLevel=r,this.sweptAwayCoordinates=i,this.field=o,this.hasBombExploded=a,this.gameLevelSettings=void 0,this.gameLevelSettings=E(r),this.gameLevel=r}return Object(l.a)(e,[{key:"boardSize",value:function(){return this.gameLevelSettings.boardSize}},{key:"sweep",value:function(e){this.isSweeperDead()||this.completelySweptAway()||(this.field?this.field.isBomb(e)?this.explodeBomb():this.sweepCoordinate(e,this.field):this.startGame(e))}},{key:"sweepCoordinate",value:function(t,n){this.sweptAwayCoordinates=this.sweptAwayCoordinates.sweep(t,n),this.field=n,this.completelySweptAway()?this.publishEvent(e.events.finished(this)):this.publishEvent(e.events.revealed(this))}},{key:"bombCount",value:function(e){return this.field?this.field.nearBombCount(e):0}},{key:"hasBombNear",value:function(e){return this.field&&this.field.hasBombNear(e)}},{key:"isSwept",value:function(e){return this.field&&this.sweptAwayCoordinates.isRevealed(e)}},{key:"isSweeperDead",value:function(){return this.hasBombExploded}},{key:"completelySweptAway",value:function(){return this.field&&!this.sweptAwayCoordinates.hasCoordinatesToBeSwept(this.field)}},{key:"startGame",value:function(t){this.field=this.createBoard(t),this.sweptAwayCoordinates=this.sweptAwayCoordinates.sweep(t,this.field),this.publishEvent(e.events.started(this))}},{key:"createBoard",value:function(e){var t=this.mineFactory(e,this.gameLevelSettings.mineProbability);return g(t)(this.boardSize())}},{key:"publishEvent",value:function(e){this.eventPublisher.publish(e)}},{key:"explodeBomb",value:function(){this.hasBombExploded=!0,this.publishEvent(e.events.gameOver(this))}}]),e}();C.events={created:h("MINESWEEPER_CREATED"),started:h("MINESWEEPER_STARTED"),revealed:h("MINESWEEPER_REVEALED"),gameOver:h("MINESWEEPER_OVER"),finished:h("MINESWEEPER_FINISHED")};var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return function(n){return new C(e,t,n)}},k=o.a.createContext(function(){var e=[],t=0;return{listen:function(n,r){return t++,e.push({subscriptionID:t,eventCreator:n,callback:r}),t},publish:function(t){var n="object"===typeof t.payload?Object.assign(Object.create(Object.getPrototypeOf(t.payload)),t.payload):t.payload;e.filter((function(e){return e.eventCreator.isTypeOf(t)})).forEach((function(e){return e.callback(n)}))},unsubscribe:function(t){e=e.filter((function(e){return e.subscriptionID!==t}))}}}()),j=n(1),A=n(2);function S(){var e=Object(j.a)(["\n  border: 0;\n  border-radius: 10px;\n  padding: 1rem 2rem;\n  box-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.3);\n  transition: box-shadow 0.2s ease-in-out;\n  color: #333;\n  \n  &:hover {\n    box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.5);  \n  } \n"]);return S=function(){return e},e}var M=A.a.button(S());function N(){var e=Object(j.a)(["\n    background-color: ","\n    transition: background-color 0.5s ease-in-out, box-shadow 0.2s ease-in-out;\n    \n    &:hover {\n       background-color: ","\n    }\n"]);return N=function(){return e},e}var D=Object(A.a)((function(e){var t=e.children,n=e.onClick,r=e.className;return o.a.createElement(M,{className:r,onClick:function(){return n()}},t)}))(N(),(function(e){switch(e.level){case b.EASY:return"#E6FFD9";case b.MEDIUM:return"#FFE67F";case b.HARD:return"#E64D5A"}}),(function(e){switch(e.level){case b.EASY:return"#d2ebc6";case b.MEDIUM:return"#ebd276";case b.HARD:return"#eb4d5a"}}));function I(){var e=Object(j.a)(["\n  margin: 0 0 20px;\n  padding: 0;\n  font-family: 'Open Sans', sans-serif;\n"]);return I=function(){return e},e}function R(){var e=Object(j.a)(["\n  margin: 10px 0;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n"]);return R=function(){return e},e}function B(){var e=Object(j.a)(["\n  display: flex;\n  flex-direction: column;\n"]);return B=function(){return e},e}function F(){var e=Object(j.a)(["\n  border-radius: 10px;\n  border: 1px solid #767c8a;\n  padding: 20px;\n"]);return F=function(){return e},e}var P=A.a.section(F()),_=A.a.section(B()),T=Object(A.a)((function(e){var t=e.onClick,n=e.level,r=e.className;return o.a.createElement(D,{onClick:function(){return t()},className:r,level:n},n)}))(R()),W=A.a.h1(I()),L=function(e){var t=e.onSelect;return o.a.createElement(P,null,o.a.createElement(W,null,"Choose the Game Level"),o.a.createElement(_,null,Object.values(b).map((function(e){return o.a.createElement(T,{key:e,level:e,onClick:function(){return t(e)}})}))))},H=function(){function e(t){Object(c.a)(this,e),this.eventPublisher=t,this.minesweeperFactory=void 0,this.minesweeperFactory=x(this.eventPublisher)}return Object(l.a)(e,[{key:"create",value:function(e){var t=this.minesweeperFactory(e);this.eventPublisher.publish(C.events.created(t))}}]),e}(),z=function(e){return"REVEALED_WITH_NO_BOMB_NEAR"===e.type},G=function(e){return"REVEALED_WITH_BOMB_NEAR"===e.type},V=function(e){return"FLAGGED"===e.type};function Y(){var e=Object(j.a)(["\n  background: ",";\n  font-size: ",";\n  color: ",";\n"]);return Y=function(){return e},e}var U=A.a.button(Y(),(function(e){return function(e){return G(e)||z(e)}(e.boardCoordinate)?"#FCFCFC":"#EFEFEF"}),(function(e){var t=e.boardCoordinate;return V(t)?"0.6rem":"1.2rem"}),(function(e){var t=e.boardCoordinate;if(!G(t))return"#000000";switch(t.bombCount){case 1:return"#42b5e6";case 2:return"#6de637";case 3:return"#e6e62d";case 4:return"#e6b13a";case 5:return"#bf6be6";case 6:return"#e6549f";case 7:return"#e65282"}return"#E64D5A"})),J=function(e){return V(e)?"Coordinate ".concat($(e.coordinate)," flagged"):z(e)?"Coordinate ".concat($(e.coordinate)," reveled with no bomb near"):G(e)?"Coordinate ".concat($(e.coordinate)," reveled with ").concat(e.bombCount," bombs near"):"Coordinate ".concat($(e.coordinate))},$=function(e){return e.x+1+"x"+(e.y+1)},q=function(){function e(t,n){Object(c.a)(this,e),this.minesweeper=t,this.mineIndicator=n}return Object(l.a)(e,[{key:"boardCoordinates",value:function(){var e,t=this;return(e=this.boardTotalCoordinates(),Array.from({length:e},(function(e,t){return t}))).map((function(e){return t.coordinateFromIndex(e)})).map((function(e){return t.boardCoordinate(e)}))}},{key:"boardTotalCoordinates",value:function(){return this.minesweeper.boardSize().width*this.minesweeper.boardSize().height}},{key:"coordinateFromIndex",value:function(e){return m.of({x:e%this.minesweeper.boardSize().width,y:Math.trunc(e/this.minesweeper.boardSize().width)})}},{key:"boardCoordinate",value:function(e){return this.mineIndicator&&this.mineIndicator.isFlagged(e)?function(e){return{type:"FLAGGED",coordinate:e}}(e):this.minesweeper.isSwept(e)?this.minesweeper.hasBombNear(e)?function(e,t){return{type:"REVEALED_WITH_BOMB_NEAR",coordinate:e,bombCount:t}}(e,this.minesweeper.bombCount(e)):function(e){return{type:"REVEALED_WITH_NO_BOMB_NEAR",coordinate:e}}(e):function(e){return{type:"NOT_REVEALED",coordinate:e}}(e)}}]),e}();function K(){var e=Object(j.a)(["\n  border: 2px solid ",";\n  transition: border 0.25s linear;\n"]);return K=function(){return e},e}function Q(){var e=Object(j.a)(["\n  display: grid;\n  grid-column-gap: 10px;\n  grid-row-gap: 10px;\n  width: 500px;\n  height: ",";\n  grid-template-columns: repeat(",", 1fr);\n  grid-template-rows: repeat(",", 1fr);\n"]);return Q=function(){return e},e}var X=A.a.section(Q(),(function(e){return 500/e.width*e.height+"px"}),(function(e){return e.width}),(function(e){return e.height})),Z=Object(A.a)((function(e){var t=e.onClick,n=e.onMouseEnter,r=e.boardCoordinate,i=e.className,a=e.onContextMenu;return o.a.createElement(U,{onClick:function(){return t()},onContextMenu:function(e){e.preventDefault(),a()},className:i,onMouseEnter:function(){return n()},"aria-label":J(r),boardCoordinate:r},function(e){return V(e)?"\ud83d\udea9":G(e)?e.bombCount:null}(r))}))(K(),(function(e){return e.highlightedCoordinates.some((function(t){return t.sameOf(e.boardCoordinate.coordinate)}))?"#a3b6d2":"#d1dbf0"})),ee=function(e){var t=e.game,n=e.mineIndicator,r=Object(i.useState)([]),a=Object(s.a)(r,2),u=a[0],c=a[1];return o.a.createElement(X,t.boardSize(),new q(t,n).boardCoordinates().map((function(e,r){return o.a.createElement(Z,{highlightedCoordinates:u,onContextMenu:function(){return n&&n.toggleFlag(e.coordinate)},onMouseEnter:function(){return c(e.coordinate.getAdjacent())},onClick:function(){return(!n||!n.isFlagged(e.coordinate))&&t.sweep(e.coordinate)},boardCoordinate:e,key:r})})))};function te(){var e=Object(j.a)(["\n  animation: "," 0.2s forwards;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  text-align: center;\n  top: 0;\n  left: 0;\n\n  div {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.5);\n    padding: 5rem;\n    text-align: center;\n  }\n"]);return te=function(){return e},e}function ne(){var e=Object(j.a)(["\n  from {\n    -webkit-transform: translate3d(0, -100%, 0);\n    transform: translate3d(0, -100%, 0);\n    visibility: visible;\n  }\n\n  to {\n    -webkit-transform: translate3d(0, 0, 0);\n    transform: translate3d(0, 0, 0);\n  }\n"]);return ne=function(){return e},e}var re=Object(A.b)(ne()),ie=A.a.section(te(),re),oe=function(e){var t=e.children,n=e.className;return o.a.createElement(ie,{className:n},o.a.createElement("div",null,t))};function ae(){var e=Object(j.a)(["\n    color: red;\n"]);return ae=function(){return e},e}var ue=Object(A.a)(oe)(ae()),se=function(){return o.a.createElement(ue,null,o.a.createElement("h1",null,"Game Over!"))};function ce(){var e=Object(j.a)(["\n    color: #5f9898;\n"]);return ce=function(){return e},e}var le=Object(A.a)(oe)(ce()),de=function(){return o.a.createElement(le,null,o.a.createElement("h1",null,"You Win!"))},fe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(c.a)(this,e),this.eventPublisher=t,this.coordinates=n}return Object(l.a)(e,[{key:"toggleFlag",value:function(e){return this.isFlagged(e)?this.removeFlag(e):this.addFlag(e)}},{key:"addFlag",value:function(t){var n=[].concat(Object(w.a)(this.coordinates),[t]),r=new e(this.eventPublisher,n);return this.eventPublisher.publish(e.events.flagAdded(r)),r}},{key:"removeFlag",value:function(t){var n=this.coordinates.filter((function(e){return!e.sameOf(t)})),r=new e(this.eventPublisher,n);return this.eventPublisher.publish(e.events.flagRemoved(r)),r}},{key:"isFlagged",value:function(e){return this.coordinates.some((function(t){return t.sameOf(e)}))}}]),e}();fe.events={created:h("MINE_INDICATOR_CREATED"),flagAdded:h("MINE_INDICATOR_ADDED"),flagRemoved:h("MINE_INDICATOR_REMOVED")};var he=function(){function e(t){Object(c.a)(this,e),this.eventPublisher=t}return Object(l.a)(e,[{key:"create",value:function(){var e=new fe(this.eventPublisher);this.eventPublisher.publish(fe.events.created(e))}}]),e}(),be=function(){var e=Object(i.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(),u=Object(s.a)(a,2),c=u[0],l=u[1],d=Object(i.useContext)(k),h=new H(d),b=new he(d);return Object(i.useEffect)((function(){var e=d.listen(C.events.created,(function(){return b.create()})),t=d.listen(f([fe.events.created,fe.events.flagAdded,fe.events.flagRemoved]),l),n=d.listen(f([C.events.created,C.events.started,C.events.revealed,C.events.gameOver,C.events.finished]),r);return function(){d.unsubscribe(n),d.unsubscribe(e),d.unsubscribe(t)}}),[d,b,n]),o.a.createElement("div",{className:"App"},!n&&o.a.createElement(L,{onSelect:function(e){return h.create(e)}}),n&&c&&o.a.createElement(ee,{game:n,mineIndicator:c}),n&&n.isSweeperDead()&&o.a.createElement(se,null),n&&n.completelySweptAway()&&o.a.createElement(de,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(o.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[16,1,2]]]);
//# sourceMappingURL=main.8cc3e3be.chunk.js.map